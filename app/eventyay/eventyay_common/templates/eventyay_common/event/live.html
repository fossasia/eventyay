{% extends "eventyay_common/event/base.html" %}
{% load i18n %}
{% load bootstrap3 %}
{% block content %}
    <nav id="event-nav" class="header-nav">
        <div class="navigation">
            <div class="navigation-title">
                <h1>{% trans "Event status" %}</h1>
            </div>
            {% include "eventyay_common/event/component_link.html" %}
        </div>
    </nav>
    <legend>
        {% trans "Event Status" %}
    </legend>
    <div class="panel panel-default">
        <div class="panel-heading">
            {% trans "Event visibility" %}
        </div>
        <div class="panel-body">
            {% if request.event.live %}
                <p>
                    {% trans "Your event is currently live. If you take it down, it will only be visible to you and your team." %}
                </p>
                {% if issues|length > 0 %}
                    <div class="alert alert-warning">
                        <p>
                            {% trans "Your event is already live, however the following issues would normally prevent ticket sales from going live:" %}
                        </p>
                        <ul>
                            {% for issue in issues %}
                                <li>{{ issue|safe }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                <form action="" method="post" class="text-right flip">
                    {% csrf_token %}
                    <input type="hidden" name="live" value="false">
                    <button type="submit" class="btn btn-lg btn-danger btn-save">
                        {% trans "Go offline" %}
                    </button>
                </form>
            {% else %}
                {% if issues|length > 0 %}
                    <p>
                        {% trans "Your event is currently offline. It is only visible to you and your team, not to any visitors." %}
                    </p>
                    <div class="alert alert-warning">
                        <p>
                            {% trans "To publish your event, you first need to resolve the following issues:" %}
                        </p>
                        <ul>
                            {% for issue in issues %}
                                <li>{{ issue|safe }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="test-right">
                        <button type="submit" class="btn btn-primary btn-lg btn-save" disabled>
                            {% trans "Go live" %}
                        </button>
                    </div>
                {% else %}
                    <p>
                        {% trans "Your event is currently not live. It is only visible to you and your team, not to any visitors." %}
                    </p>
                    <p>
                        {% trans "The ticket shop is not set up yet, but you can still publish the event now." %}
                    </p>
                    <form action="" method="post" class="flip text-right">
                        {% csrf_token %}
                        <input type="hidden" name="live" value="true">
                        <button type="submit" class="btn btn-primary btn-lg btn-save">
                            {% trans "Go live" %}
                        </button>
                    </form>
                {% endif %}
            {% endif %}
            <div class="clear"></div>
        </div>
    </div>
    <div class="clear"></div>
    <legend>
        {% trans "Tickets" %}
    </legend>
    {% include "eventyay_common/event/fragment_ticket_modes.html" %}
    <div class="clear"></div>
    <legend>
        {% trans "Talk" %}
    </legend>
    <div class="panel panel-default">
        <div class="panel-heading">
            {% trans "Test mode" %}
        </div>
        <div class="panel-body">
            {% if talks_testmode %}
                <form action="" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="talk_testmode" value="false">
                    <p>
                        {% trans "Talk pages are currently in test mode. Schedule and submission data can change and should not be treated as final." %}
                    </p>
                    <div class="text-right">
                        <button type="submit" class="btn btn-lg btn-primary btn-save">
                            {% trans "Disable talk test mode" %}
                        </button>
                    </div>
                </form>
            {% else %}
                {% if private_testmode_talks %}
                    <p>
                        {% trans "Private test mode is currently enabled for talks. Disable it to enable talk test mode." %}
                    </p>
                    <div class="text-right">
                        <button type="button" class="btn btn-lg btn-default btn-save" disabled>
                            {% trans "Enable talk test mode" %}
                        </button>
                    </div>
                {% else %}
                    <p>
                        {% trans "Talk pages are currently in production mode. Enable talk test mode to preview schedules and submissions without treating them as final." %}
                    </p>
                    <form action="" method="post" class="text-right">
                        {% csrf_token %}
                        <input type="hidden" name="talk_testmode" value="true">
                        <button type="submit" class="btn btn-lg btn-default btn-save">
                            {% trans "Enable talk test mode" %}
                        </button>
                    </form>
                {% endif %}
            {% endif %}
            <div class="clear"></div>
        </div>
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            {% trans "Private test mode" %}
        </div>
        <div class="panel-body">
            {% if private_testmode_talks %}
                <p>
                    {% trans "Private test mode is enabled for talks. Only organizers, reviewers, and system administrators can access the schedule, sessions, speakers, and call for speakers." %}
                </p>
                <form action="" method="post" class="text-right">
                    {% csrf_token %}
                    <input type="hidden" name="private_testmode_talks_action" value="disable">
                    <button type="submit" class="btn btn-lg btn-primary btn-save">
                        {% trans "Disable private test mode for talks" %}
                    </button>
                </form>
            {% else %}
                {% if request.event.testmode %}
                    <p>
                        {% trans "Test mode is currently enabled. Disable it to enable private test mode for talks." %}
                    </p>
                    <div class="text-right">
                        <button type="button" class="btn btn-lg btn-default btn-save" disabled>
                            {% trans "Enable private test mode for talks" %}
                        </button>
                    </div>
                {% elif talks_testmode %}
                    <p>
                        {% trans "Talk test mode is currently enabled. Disable it to enable private test mode for talks." %}
                    </p>
                    <div class="text-right">
                        <button type="button" class="btn btn-lg btn-default btn-save" disabled>
                            {% trans "Enable private test mode for talks" %}
                        </button>
                    </div>
                {% else %}
                    <p>
                        {% trans "Private test mode hides talk pages from the public. Only organizers, reviewers, and system administrators can access them." %}
                    </p>
                    <form action="" method="post" class="text-right">
                        {% csrf_token %}
                        <input type="hidden" name="private_testmode_talks_action" value="enable">
                        <button type="submit" class="btn btn-lg btn-default btn-save">
                            {% trans "Enable private test mode for talks" %}
                        </button>
                    </form>
                {% endif %}
            {% endif %}
            <div class="clear"></div>
        </div>
    </div>
    <div class="clear"></div>
    <div class="text-right">
        <a href="{% url "control:event.dangerzone" organizer=request.organizer.slug event=request.event.slug %}"
                class="btn btn-delete btn-danger btn-default btn-lg">
            <span class="fa fa-trash"></span>
            {% trans "Cancel or delete event" %}
        </a>
    </div>
{% endblock %}
