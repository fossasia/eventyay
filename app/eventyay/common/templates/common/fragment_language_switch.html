{% load i18n %}

{% translate "Language" as language_label %}

<li class="nav-item">
    <form method="post" action="{% url 'eventyay_common:account.locale' %}" class="language-form">
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ request.get_full_path }}">

        <details class="dropdown fix-height" id="language-dropdown" aria-haspopup="menu">
            <summary class="header-nav" aria-label="{{ language_label }}">
                <i class="fa fa-globe"></i>
                {% for option in language_options %}
                    {% if option.code|lower == request.LANGUAGE_CODE|lower %}
                        <span class="current-locale">{{ option.label }}</span>
                    {% endif %}
                {% endfor %}
                <i class="fa fa-caret-down" aria-hidden="true"></i>
            </summary>

            <div class="dropdown-content dropdown-content-s{% if rtl %}e{% else %}w{% endif %}" role="menu">
                {% for option in language_options %}
                    <!-- Base Language -->
                    {% if not option.variants %}
                         <!-- Logic for simple language item -->
                         <button type="submit"
                            name="locale"
                            value="{{ option.code }}"
                            class="dropdown-item {% if option.code|lower == request.LANGUAGE_CODE|lower %}active{% endif %}"
                            role="menuitem">
                            {{ option.styled_name }}
                        </button>
                    {% else %}
                        <!-- Logic for language with variants -->
                        <div class="dropdown-header">
                             {{ option.styled_name }}
                        </div>
                        {% for variant in option.variants %}
                            <button type="submit"
                                name="locale"
                                value="{{ variant.code }}"
                                class="dropdown-item pl-4 {% if variant.code|lower == request.LANGUAGE_CODE|lower %}active{% endif %}"
                                role="menuitem">
                                {{ variant.name }}
                            </button>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </div>
        </details>
    </form>
</li>
